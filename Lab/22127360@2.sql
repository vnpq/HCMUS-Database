CREATE DATABASE QLGiaoVienThamGiaDeTai;
GO

USE QLGiaoVienThamGiaDeTai;
GO

CREATE TABLE GIAOVIEN (
	MAGV CHAR(10) PRIMARY KEY,
	HOTEN NCHAR(100),
    LUONG DECIMAL(18, 2),
    PHAI NCHAR(3),
    NGAYSINH DATE,
    DIACHI NCHAR(100),
    GVQLCM CHAR(10),
    MABM CHAR(10),
	FOREIGN KEY (GVQLCM) REFERENCES GIAOVIEN(MAGV)
);
GO

CREATE TABLE GV_DT (
    MAGV CHAR(10),
    DIENTHOAI CHAR(20),
    PRIMARY KEY (MAGV, DIENTHOAI),
    FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV)
);
GO

CREATE TABLE KHOA (
    MAKHOA CHAR(10) PRIMARY KEY,
    TENKHOA NCHAR(100),
    NAMTL INT,
    PHONG NCHAR(50),
    DIENTHOAI CHAR(20),
	TRUONGKHOA CHAR(10),
    NGAYNHANCHUC DATE,
	FOREIGN KEY (TRUONGKHOA) REFERENCES GIAOVIEN(MAGV)
);
GO

CREATE TABLE BOMON (
    MABM CHAR(10) PRIMARY KEY,
    TENBM NCHAR(100),
    PHONG NCHAR(50),
    DIENTHOAI CHAR(20),
    TRUONGBM CHAR(10),
    MAKHOA CHAR(10),
    NGAYNHANCHUC DATE,
    FOREIGN KEY (MAKHOA) REFERENCES KHOA(MAKHOA),
	FOREIGN KEY (TRUONGBM) REFERENCES GIAOVIEN(MAGV)
);
GO

ALTER TABLE GIAOVIEN ADD CONSTRAINT MABM
FOREIGN KEY (MABM) REFERENCES BOMON(MABM)
GO

CREATE TABLE CHUDE (
    MACD CHAR(10) PRIMARY KEY,
    TENCD NCHAR(200)
);
GO

CREATE TABLE DETAI (
    MADT CHAR(10) PRIMARY KEY,
    TENDT NCHAR(200),
	CAPQL NCHAR(50),
    KINHPHI DECIMAL(18, 2),
    NGAYBD DATE,
    NGAYKT DATE,
    MACD CHAR(10),
    GVCNDT CHAR(10),
    FOREIGN KEY (MACD) REFERENCES CHUDE(MACD),
    FOREIGN KEY (GVCNDT) REFERENCES GIAOVIEN(MAGV)
);
GO

CREATE TABLE CONGVIEC (
    MADT CHAR(10),
    STT INT,
    TENCV NCHAR(200),
    NGAYBD DATE,
    NGAYKT DATE,
    PRIMARY KEY (MADT, STT),
    FOREIGN KEY (MADT) REFERENCES DETAI(MADT)
);
GO

CREATE TABLE THAMGIADT (
    MAGV CHAR(10),
    MADT CHAR(10),
    STT INT,
    PHUCAP DECIMAL(18, 2),
    KETQUA NCHAR(200),
    PRIMARY KEY (MAGV, MADT, STT),
    FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV),
    FOREIGN KEY (MADT, STT) REFERENCES CONGVIEC(MADT, STT)
);
GO

CREATE TABLE NGUOITHAN(
	MAGV CHAR(10),
	TEN NCHAR(200),
	NGSINH DATE,
	PHAI NCHAR(3),
	PRIMARY KEY(MAGV, TEN),
	FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV)
);
GO

INSERT INTO CHUDE VALUES ('NCPT', N'Nghiên cứu phát triển');
INSERT INTO CHUDE VALUES ('QLGD', N'Quản lý giáo dục');
INSERT INTO CHUDE VALUES ('UDCN', N'Ứng dụng công nghệ');
GO

INSERT INTO KHOA VALUES ('CNTT', N'Công nghệ thông tin', 1995, 'B11', '0838123456', NULL, '02/20/2005');
INSERT INTO KHOA VALUES ('HH', N'Hóa học', 1980, 'B41', '0838456456', NULL, '10/15/2001');
INSERT INTO KHOA VALUES ('SH', N'Sinh học', 1980, 'B31', '0838454545', NULL, '10/11/2000');
INSERT INTO KHOA VALUES ('VL', N'Vật lý', 1976, 'B21', '0838223223', NULL, '09/18/2003');
GO

INSERT INTO BOMON VALUES ('CNTT', N'Công nghệ tri thức', 'B15', '0838126126', NULL, 'CNTT', NULL);
INSERT INTO BOMON VALUES ('HHC', N'Hóa hữu cơ', 'B44', '08382222222', NULL, 'HH', NULL);
INSERT INTO BOMON VALUES ('HL', N'Hóa lý', 'B42', '0838878787', NULL, 'HH', NULL);
INSERT INTO BOMON VALUES ('HPT', N'Hóa phân tích', 'B43', '0838777777', NULL, 'HH', '10/15/2007');
INSERT INTO BOMON VALUES ('HTTT', N'Hệ thống thông tin', 'B13', '0838125125', NULL, 'CNTT', '09/20/2004');
INSERT INTO BOMON VALUES ('MMT', N'Mạng máy tính', 'B16', '0838676767', NULL, 'CNTT', '05/15/2005');
INSERT INTO BOMON VALUES ('SH', N'Sinh hóa', 'B33', '0838898989', NULL, 'SH', NULL);
INSERT INTO BOMON VALUES ('VLDT', N'Vật lý điện tử', 'B23', '0838234234', NULL, 'VL', NULL);
INSERT INTO BOMON VALUES ('VLUD', N'Vật lý ứng dụng', 'B24', '0838454545', NULL, 'VL', '02/12/2006');
INSERT INTO BOMON VALUES ('VS', N'Vi sinh', 'B32', '0838909090', NULL, 'SH', '01/01/2007');
GO

INSERT INTO GIAOVIEN VALUES ('001', N'Nguyễn Hoài An', 2000, 'Nam', '02/15/1973', N'25/3 Lạc Long Quân, Q.10, TP HCM', NULL, 'MMT');
INSERT INTO GIAOVIEN VALUES ('002', N'Trần Trà Hương', 2500, N'Nữ', '06/20/1960', N'125 Trần Hưng Đạo, Q.1, TP HCM', NULL, 'HTTT');
INSERT INTO GIAOVIEN VALUES ('003', N'Nguyễn Ngọc Ánh', 2200, N'Nữ', '05/11/1975', N'12/21 Võ Văn Ngân Thủ Đức, TP HCM', '002', 'HTTT');
INSERT INTO GIAOVIEN VALUES ('004', N'Trương Nam Sơn', 2300, 'Nam', '06/20/1959', N'215 Lý Thường Kiệt, TP Biên Hòa', NULL, 'VS');
INSERT INTO GIAOVIEN VALUES ('005', N'Lý Hoàng Hà', 2500, 'Nam', '10/23/1954', N'22/5 Nguyễn Xí, Q.Bình Thạnh, TP HCM', NULL, 'VLDT');
INSERT INTO GIAOVIEN VALUES ('006', N'Trần Bạch Tuyết', 1500, N'Nữ', '05/20/1980', N'127 Hùng Vương, TP Mỹ Tho', '004', 'VS');
INSERT INTO GIAOVIEN VALUES ('007', N'Nguyễn An Trung', 2100, 'Nam', '06/05/1976', N'234 3/2, TP Biên Hòa', NULL, 'HPT');
INSERT INTO GIAOVIEN VALUES ('008', N'Trần Trung Hiếu', 1800, 'Nam', '08/06/1977', N'22/11 Lý Thường Kiệt, TP Mỹ Tho', '007', 'HPT');
INSERT INTO GIAOVIEN VALUES ('009', N'Trần Hoàng Nam', 2000, 'Nam', '11/12/1975', N'234 Trần Não, An Phú,TP HCM', '001', 'MMT');
INSERT INTO GIAOVIEN VALUES ('010', N'Phạm Nam Thanh', 1500, 'Nam', '12/12/1980', N'221 Hùng Vương, Q.5, TP HCM', '007', 'HPT');
GO

UPDATE BOMON SET TRUONGBM = '007' WHERE MABM = 'HPT';
UPDATE BOMON SET TRUONGBM = '002' WHERE MABM = 'HTTT';
UPDATE BOMON SET TRUONGBM = '001' WHERE MABM = 'MMT';
UPDATE BOMON SET TRUONGBM = '005' WHERE MABM = 'VLUD';
UPDATE BOMON SET TRUONGBM = '004' WHERE MABM = 'VS';
GO

UPDATE KHOA SET TRUONGKHOA = '002' WHERE MAKHOA = 'CNTT';
UPDATE KHOA SET TRUONGKHOA = '007' WHERE MAKHOA = 'HH';
UPDATE KHOA SET TRUONGKHOA = '004' WHERE MAKHOA = 'SH';
UPDATE KHOA SET TRUONGKHOA = '005' WHERE MAKHOA = 'VL';
GO

INSERT INTO GV_DT VALUES ('001', '0838912112');
INSERT INTO GV_DT VALUES ('001', '0903123123');
INSERT INTO GV_DT VALUES ('002', '0913454545');
INSERT INTO GV_DT VALUES ('003', '0838121212');
INSERT INTO GV_DT VALUES ('003', '0903656565');
INSERT INTO GV_DT VALUES ('003', '0937125125');
INSERT INTO GV_DT VALUES ('006', '0937888888');
INSERT INTO GV_DT VALUES ('008', '0653717171');
INSERT INTO GV_DT VALUES ('008', '0913232323');
GO

INSERT INTO NGUOITHAN VALUES ('001', N'Hùng', '01/14/1990', 'Nam');
INSERT INTO NGUOITHAN VALUES ('001', N'Thủy', '12/08/1994', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('003', N'Hà', '09/03/1998', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('003', N'Thu', '09/03/1998', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('007', N'Mai', '03/26/2003', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('007', N'Vy', '02/14/2000', N'Nữ');
INSERT INTO NGUOITHAN VALUES ('001', N'Nam', '05/06/1991', 'Nam');
INSERT INTO NGUOITHAN VALUES ('001', N'An', '08/19/1996', 'Nam');
INSERT INTO NGUOITHAN VALUES ('001', N'Nguyệt', '01/14/2006', N'Nữ');
GO

INSERT INTO DETAI VALUES ('001', N'HTTT quản lý các trường ĐH', N'ĐHQG', 20, '10/20/2007', '10/20/2008', 'QLGD', '002');
INSERT INTO DETAI VALUES ('002', N'HTTT quản lý giáo vụ cho một Khoa', N'Trường', 20, '12/20/2000', '12/20/2001', 'QLGD', '002');
INSERT INTO DETAI VALUES ('003', N'Nghiên cứu chế tạo sợi Nanô Platin', N'ĐHQG', 300, '05/15/2008', '05/15/2010', 'NCPT', '005');
INSERT INTO DETAI VALUES ('004', N'Tạo vật liệu sinh học bằng màng ối người', N'Nhà nước', 100, '01/01/2007', '01/01/2009', 'NCPT', '004');
INSERT INTO DETAI VALUES ('005', N'Ứng dụng hóa học xanh', N'Trường', 100, '10/10/2003', '12/10/2004', 'UDCN', '007');
INSERT INTO DETAI VALUES ('006', N'Nghiên cứu tế bào gốc', N'Nhà nước', 4000, '10/20/2006', '10/20/2009', 'NCPT', '004');
INSERT INTO DETAI VALUES ('007', N'HTTT quản lý thư viện ở các trường ĐH', N'Trường', 20, '05/10/2009', '05/10/2010', 'QLGD', '001');
GO

INSERT INTO CONGVIEC VALUES ('001', 1, N'Khởi tạo và Lập kế hoạch', '10/20/2007', '12/20/2008');
INSERT INTO CONGVIEC VALUES ('001', 2, N'Xác định yêu cầu', '12/21/2008', '03/21/2008');
INSERT INTO CONGVIEC VALUES ('001', 3, N'Phân tích hệ thống', '03/22/2008', '05/22/2008');
INSERT INTO CONGVIEC VALUES ('001', 4, N'Thiết kế hệ thống', '05/23/2007', '06/23/2008');
INSERT INTO CONGVIEC VALUES ('001', 5, N'Cài đặt thủ nghiệm', '06/24/2007', '10/20/2008');
INSERT INTO CONGVIEC VALUES ('002', 1, N'Khởi tạo và Lập kế hoạch', '05/10/2009', '07/10/2009');
INSERT INTO CONGVIEC VALUES ('002', 2, N'Xác định yêu cầu', '07/11/2009', '10/11/2009');
INSERT INTO CONGVIEC VALUES ('002', 3, N'Phân tích hệ thống', '10/12/2009', '12/20/2009');
INSERT INTO CONGVIEC VALUES ('002', 4, N'Thiết kế hệ thống', '12/21/2009', '03/22/2010');
INSERT INTO CONGVIEC VALUES ('002', 5, N'Phân tích hệ thống', '03/23/2010', '05/10/2010');
INSERT INTO CONGVIEC VALUES ('006', 1, N'Lấy mẫu', '10/20/2006', '02/20/2007');
INSERT INTO CONGVIEC VALUES ('006', 2, N'Nuôi cấy', '02/21/2007', '08/21/2008');
GO

INSERT INTO THAMGIADT VALUES ('001', '002', 1, 0, NULL);
INSERT INTO THAMGIADT VALUES ('001', '002', 2, 2, NULL);
INSERT INTO THAMGIADT VALUES ('002', '001', 4, 2, N'Đạt'); 
INSERT INTO THAMGIADT VALUES ('003', '001', 1, 1, N'Đạt');
INSERT INTO THAMGIADT VALUES ('003', '001', 2, 0, N'Đạt');
INSERT INTO THAMGIADT VALUES ('003', '001', 4, 1, N'Đạt');
INSERT INTO THAMGIADT VALUES ('003', '002', 2, 0, NULL);
INSERT INTO THAMGIADT VALUES ('004', '006', 1, 0, N'Đạt');
INSERT INTO THAMGIADT VALUES ('001', '006', 2, 1, N'Đạt');
INSERT INTO THAMGIADT VALUES ('004', '006', 2, 1.5, N'Đạt');
INSERT INTO THAMGIADT VALUES ('006', '002', 3, 0.5, NULL);
INSERT INTO THAMGIADT VALUES ('009', '002', 4, 1.5, NULL);
GO

USE master;
GO